library(ggplot2)
sejong.poll.2.seoul <- subset(sejong.poll.2, region == "Seoul")
sejong.poll.2.seoul
ggplot(sejong.poll.2[region=="Seoul", ], aes(x=class, y=counts, fill=vote)) +
geom_bar(stat="identity")
?barplot
?tabs
?xtabs
setwd("~/Desktop/Works")
library(xlsx)
data0 <- read.xlsx("data1.xlsx", 1, startRow=3, endRow=32, colIndex=3:7, colClasses=rep("numeric", 5), header=FALSE)
data0
data1 <- read.xlsx("data1.xlsx", 1, startRow=3, endRow=32, colIndex=3:7, colClasses=rep("numeric", 5), header=FALSE)
data1
data6 <- data1[-c(9, 11, 23, 26), ]
setwd("~/Desktop/Works/Project")
library(extrafont)
pie(rep(1, 7), col = rainbow(7))
pie(rep(1, 14), col = rainbow(14))
pie(rep(1, 7), col = rainbow(7))
?array
pie(rep(1, 14), col = rainbow(14))
pie(rep(1, 21), col = rainbow(21))
pie(rep(1, 35), col = rainbow(35))
?colors
pie(rep(1, 12), col = rgb((0:11)/11, green = 0, blue = 0, names = paste("red", 0:15, sep = ".")))
pie(rep(1, 12), col = rgb((0:11)/12, green = 0, blue = 0, names = paste("red", 0:15, sep = ".")))
?colors
pie(rep(1, 12), col = rgb((0:11)/12, green = 0, blue = 0, names = paste("red", 0:11, sep = ".")))
pie(rep(1, 12), col = rgb((0:11)/12, green = 0.5, blue = 0, names = paste("red", 0:11, sep = ".")))
pie(rep(1, 12), col = rgb((0:11)/12, green = 0.5, blue = 0.5, names = paste("red", 0:11, sep = ".")))
gray.colors
?gray.colors
pie(rep(1, 12), col = gray.colors(12))
?xtabs
?kable
?format
?xtabs
?subset
?format
ls()
setwd("~/Google 드라이브/Works/Class/Case_Studies_in_Stat/R.WD/Sejong/R")
load("./sejong_poll_kor.rda")
ls()
sejong.poll.kr
sejong.poll.kr.officers
rm(list = ls())
load("./sejong_poll_kor.RData")
ls()
data
rm(list = ls())
load("./sejong_poll_data.rda")
ls()
names(sejong.poll)
?col.names
?`[]
`
?`[
`
?kable
?xtabs
load("./sejong_poll_data.rda")
kable(sejong.poll[4:1])
library(knitr)
kable(sejong.poll[4:1])
sejong.poll.kr <- sejong.poll
sejong.poll.kr$vote <- factor(sejong.poll.kr$vote, levels = c("yes", "no"), labels = c("찬성", "반대"))
class.labels.kr <- c("대신 등", "수령",  "3품이하현직", "3품이하전직", "품관촌민")
sejong.poll.kr$class <- factor(sejong.poll.kr$class, levels = class.levels, labels = class.labels.kr)
region.labels.kr <- c("서울", "유후사", "경기", "평안", "황해", "충청", "강원", "함길", "경상", "전라")
sejong.poll.kr$region <- factor(sejong.poll.kr$region, levels = region.levels, labels = region.labels.kr)
vnames.kr <- c("소계", "찬반", "계급", "지역")
names(sejong.poll.kr) <- vnames.kr
kable(sejong.poll.kr[4:1])
tbl.vote <- xtabs("소계" ~ "찬반", data = sejong.poll.kr)
tbl.vote <- xtabs(소계 ~ 찬반, data = sejong.poll.kr)
ls()
tbl.vote
vote.total
vote.class.2
?format
vote.region.bureau[, !"서울"]
vote.region.bureau[, -1]
?barplot
ls()
setwd("~/Google 드라이브/Works/Class/Case_Studies_in_Stat/R.WD/Sejong/R")
load("./sejong_poll.rda")
ls()
sejong.poll
rm(list = ls())
load("./sejong_poll_kr_2.rda")
ls()
sejong.poll.kr.2
ls()
rm(list=ls())
ls()
load("./sejong_poll0401.rda")
ls()
sejong.poll.kr.officers
rm(list=ls())
load("./sejong_poll_kor.rda")
ls()
rm(list=ls())
load("./sejong_poll_kor.RData")
ls()
load("./sejong_poll0401.rda")
rm(list=ls())
load("./sejong_poll0401.rda")
ls()
rm(list=ls())
load("./sejong_poll.rda")
ls()
load("./sejong_poll_kor.rda")
ls()
rm(list=ls())
load("./sejong_poll_kk_2.rda")
load("./sejong_poll_kr_2.rda")
ls()
sejong.poll.kr.2
?function
?
?dump
(vote.class.2.df <- as.data.frame(vote.class.2))
?subset
ㅣㄴ()
ls()
load("sejong_poll_data_kr.rda")
ls()
(vote.class.2.df <- as.data.frame(vote.class.2))
vote.bureaus.df <- subset(vote.class.2.df, vote.class.2.df$class.2 == "관료")
(vote.bureaus.df <- subset(vote.class.2.df, vote.class.2.df$class.2 == "관료"))
(vote.bureaus.df <- subset(vote.class.2.df, vote.class.2.df$class.2 == "관료", select = c("vote", "Freq")))
library(grid)
library(gridExtra)
?grid.arrange
ls()
as.data.frame(vote.seoul.class)
?scale_x_discrete
library(ggplot2)
?scale_x_discrete
?guides
?legend.title
??legend.title
?scale_fill_manual
vote.seoul.df <- as.data.frame(vote.seoul.class)
b1.seoul <- ggplot(vote.seoul.df, aes(x = class, y = Freq, fill = vote)) +
geom_bar(stat = "identity", position = "dodge")
b1.seoul
b2.seoul <- b1.seoul +
theme_bw(base_family = "NanumGothic") +
theme.kr +
scale_x_discrete(name = "계급") +
scale_y_continuous(name = "집계", breaks = vote.seoul.df$Freq, labels = vote.seoul.df$Freq) +
scale_fill_manual(name = "찬반", values = rainbow(2)[2:1])
source("./theme_Nanum_kr.R")
b2.seoul <- b1.seoul +
theme_bw(base_family = "NanumGothic") +
theme.kr +
scale_x_discrete(name = "계급") +
scale_y_continuous(name = "집계", breaks = vote.seoul.df$Freq, labels = vote.seoul.df$Freq) +
scale_fill_manual(name = "찬반", values = rainbow(2)[2:1])
b2.seoul
b3.seoul <- b2.seoul +
theme_void(base_family = "NanumGothic") +
theme.kr +
geom_text(aes(y = vote.seoul.df$Freq/2), label = vote.seoul.df$Freq)
b3.seoul
?position_dodge
ls()
as.data.frame(vote.region.bureau)
names(as.data.frame(vote.region.bureau))
names(as.data.frame(vote.region.bureau))[2]
unname
?unname
??ggtitle
?position_stack
vote.seoul.df
tapply(vote.seoul.df$Freq, vote.seoul.df$class, cumsum)
vote.seoul.df$Freq
unlis(tapply(vote.seoul.df$Freq, vote.seoul.df$class, cumsum))
unlist(tapply(vote.seoul.df$Freq, vote.seoul.df$class, cumsum))
str(unlist(tapply(vote.seoul.df$Freq, vote.seoul.df$class, cumsum)))
?geom_bar
?position_fill
?geom_text
ls()
ftbl.vote.class.region
ls()
tbl.region
tbl.vote.class
prop.table(tbl.vote.class)
?mosaicplot
mosaicplot(tbl.vote.class)
mosaicplot(t(tbl.vote.class))
mosaicplot(t(tbl.vote.class.region))
ls()
mosaicplot(vote.region.bureau)
mosaicplot(t(vote.region.bureau))
mosaicplot(t(vote.region.commons))
install.packages("rsconnect")
